# Учебный проект

**Auction Contract Multi-Chain Deployment.**

**Использование мостов**
---
# 1. Контракт и деплой

Контракт: Auction.sol — простой контракт аукциона, полностью в одном файле.
Изначально контракт был деплоен в Sepolia (другое домашнее задание). Для деплоя в другие сети правки кода не понадобились.

Тесты: полный комплект Hardhat-тестов для контракта.

Hardhat версия: 2.26.3.

Скрипты деплоя и верификации:

- scripts/deploy-verify.ts — Hardhat-скрипт для деплоя и верификации.

Верификация полностью работает только в Sepolia, на других сетях пока ограничена из-за перехода на Etherscan V2 API и особенностей сетевых API.

- deploy.sh — Bash-скрипт, использующий Foundry (forge) для деплоя в разные сети.

## Контракты деплоились сетях:

- BSC Testnet: 0xC8eCCBE3da5cd1C3A2b3a1D540e685646902527b

- Polygon Amoy: 0xFAAA1b54B96Ca6F00cE44Fc54828F57d1362AbA4

- opBNB Testnet: 0xFAAA1b54B96Ca6F00cE44Fc54828F57d1362AbA4

## Верификация:

- BSC Testnet: удачно верифицирован скриптом через Foundry.

- Polygon Amoy: удачно верифицирован скриптом через Foundry.

- opBNB Testnet: верификация через скрипт пока не проходит из-за ограничений opBNB API; контракт проверен вручную через интерфейс BscScan/opBNBScan.

Причина ограничений:
opBNB API пока не полностью совместим с V2 Etherscan API и не всегда корректно 
принимает запросы на верификацию через скрипт.
Остальные сети (BSC, Polygon) поддерживают автоматическую верификацию через Foundry.

---

## Тесты и деплой

Тесты:

Используется Hardhat версии 2.26.3.

Тесты работают независимо от сети на локальной сети Hardhat.

---

## Деплой и верификация через Bash-скрипт (deploy.sh):

Скрипт позволяет деплоить контракт в сети, указанные в foundry.toml и .env.

Пример запуска:
./deploy.sh polygonAmoy
./deploy.sh bsc-testnet
./deploy.sh opbnb-testnet

Скрипт выполняет:

- Загрузку переменных окружения из .env.
- Определение RPC и Chain ID для выбранной сети.
- Деплой контракта через forge create с приватным ключом.
- Попытку автоматической верификации через Etherscan/Polygonscan/BscScan.

Особенности верификации:

BSC Testnet и Polygon Amoy: контракт верифицируется автоматически скриптом.

opBNB Testnet: автоматическая верификация не проходит; требуется ручная верификация через интерфейс.

Причина: особенности поддержки V2 API и политики сети; скрипт не учитывает все нюансы opBNB.

Примечания:

Скрипт и конфигурация рассчитаны на единый контракт Auction.sol.

Для других контрактов или сетей могут потребоваться дополнительные настройки компилятора и путей.

Скрипты и конфигурация:

deploy.sh — Bash-скрипт для деплоя и верификации через Foundry.

scripts/deploy-verify.ts — скрипт для деплоя и верификации через Hardhat (верификация корректна только для Sepolia).

---

## 2. Cross-Chain Token Transfer Script

Cкрипт реализует передачу токенов между сетями Ethereum Sepolia и BSC Testnet с использованием Wormhole SDK
Файл скрипта: **bridge/bridge.ts**

### Основные особенности

- Используется Wormhole SDK для упрощения cross-chain взаимодействий, включая:
    генерацию Signer для разных сетей,
    создание high-level TokenTransfer,
    отслеживание VAA (attestation) и завершение трансфера на целевой сети.

- Поддерживается работа с нативными токенами (ETH, BNB)

### Запуск скрипта командой:

```bash
npx tsx bridge/bridge.ts
```

### Пример транзакции
(Sepolia → BSC Testnet):

https://www.wormholescan.io/tx/0xa1c6b49228aab31994b7b4eb9ab25d53e47cdcde2bcf523976c51249ec69a059
